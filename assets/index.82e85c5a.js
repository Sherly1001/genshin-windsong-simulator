var v=Object.defineProperty;var k=(t,e,n)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var l=(t,e,n)=>(k(t,typeof e!="symbol"?e+"":e,n),n);import{o as i,c as a,F as m,r as y,n as w,a as d,b as f,d as $,u as N,e as h,f as x}from"./vendor.57b4985e.js";const L=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}};L();class p{constructor(e,n){l(this,"cookies");l(this,"instrument");l(this,"instruments");this.cookies=e,this.instrument=n!=null?n:"lyre",this.instruments=["lyre","zither","piano"]}setIns(e){this.instrument=e,this.cookies.set("ins",e)}}var _=(t,e)=>{const n=t.__vccOpts||t;for(const[c,s]of e)n[c]=s;return n};const b={props:{config:{type:p,required:!0}}},S={class:"inst"},q=["onClick"],C=["src"];function O(t,e,n,c,s,o){return i(),a("div",S,[(i(!0),a(m,null,y(n.config.instruments,r=>(i(),a("div",{key:r,class:w(`ins ${r==n.config.instrument?"selected":""}`),onClick:u=>n.config.setIns(r)},[d("img",{src:`/imgs/instruments/${r}.png`},null,8,C)],10,q))),128))])}var M=_(b,[["render",O]]);const z={props:{img:{type:String,required:!0},src:{type:String,required:!0}},data(){return{last_click:Date.now()}},computed:{note(){return this.$refs.note},audio(){return this.$refs.audio}},methods:{play(t){t instanceof KeyboardEvent&&t.repeat||(this.note.classList.add("pressed"),this.audio.currentTime=0,this.audio.play(),this.last_click=Date.now())},release(t){if(Date.now()-this.last_click<10){setTimeout(()=>this.release(t),100);return}this.note.classList.remove("pressed")}}},A=["src"],B=["src"];function D(t,e,n,c,s,o){return i(),a("div",{ref:"note",class:"note",onMousedown:e[0]||(e[0]=(...r)=>o.play&&o.play(...r)),onMouseup:e[1]||(e[1]=(...r)=>o.release&&o.release(...r)),onMouseleave:e[2]||(e[2]=(...r)=>o.release&&o.release(...r))},[d("img",{src:n.img},null,8,A),d("audio",{src:n.src,ref:"audio"},null,8,B)],544)}var E=_(z,[["render",D]]);const F={props:{config:{type:p,required:!0}},components:{Note:E},data(){const t={q:"do3",w:"re3",e:"mi3",r:"fa3",t:"so3",y:"la3",u:"ti3",a:"do2",s:"re2",d:"mi2",f:"fa2",g:"so2",h:"la2",j:"ti2",z:"do1",x:"re1",c:"mi1",v:"fa1",b:"so1",n:"la1",m:"ti1"},e=Object.values(t),n=this.check_rotate();return{map_note:t,tones:e,rotate_ok:n}},computed:{notes(){const t=new Map;for(let e in this.map_note){const n=this.$refs[this.map_note[e]];n&&t.set(e,n[0])}return t}},mounted(){document.onkeydown=t=>{var e;(e=this.notes.get(t.key))==null||e.play(t)},document.onkeyup=t=>{var e;(e=this.notes.get(t.key))==null||e.release(t)},window.onresize=t=>{this.rotate_ok=this.check_rotate()},window.onorientationchange=t=>{this.rotate_ok=this.check_rotate()}},methods:{check_rotate(){return window.orientation==90||window.screen.width>window.screen.height}}},I={key:0,class:"notes"},j={key:1,class:"noti"},K=d("span",null,"please rotate the screen",-1),P=[K];function T(t,e,n,c,s,o){const r=f("Note");return s.rotate_ok?(i(),a("div",I,[(i(!0),a(m,null,y(s.tones,u=>(i(),$(r,{key:u,ref_for:!0,ref:u,img:`/imgs/notes/${u.replace(/\d+/,"")}.png`,src:`/media/${n.config.instrument}/${u}.mp3`},null,8,["img","src"]))),128))])):(i(),a("div",j,P))}var V=_(F,[["render",T]]);const{cookies:g}=N(),G={components:{Settings:M,Notes:V},data(){let t=g.get("ins");return{config:new p(g,t)}}};function H(t,e,n,c,s,o){const r=f("Settings"),u=f("Notes");return i(),a(m,null,[h(r,{config:s.config},null,8,["config"]),h(u,{config:s.config},null,8,["config"])],64)}var J=_(G,[["render",H]]);x(J).mount("#app");
